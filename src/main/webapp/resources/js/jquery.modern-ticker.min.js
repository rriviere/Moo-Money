// Modern News Ticker
// Copyright (c) CreativeTier
// contact@CreativeTier.com
(function(e){var t={effect:"scroll",autoplay:true,feedType:"none",feedCount:5,refresh:"10:00"};var n={scroll:{scrollType:"continuous",scrollStart:"inside",scrollInterval:20,transitionTime:500},fade:{displayTime:4e3,transitionTime:300},type:{typeInterval:10,displayTime:4e3,transitionTime:300},slide:{slideDistance:100,displayTime:4e3,transitionTime:350}};var r={"rss-atom":{feedUrl:"",loadType:"direct"},twitter:{twitterName:""}};var i={init:function(t){var i={};e.extend(i,{feedType:t.feedType});e.extend(i,r[i.feedType]);e.extend(i,{effect:t.effect});e.extend(i,n[i.effect]);e.extend(i,t);return this.each(function(){function x(){var e=h.width();if(p.length)e-=p.outerWidth()+parseFloat(p.css("margin-right"));if(g.length)e-=g.outerWidth()+parseFloat(g.css("margin-left"));d.css("width",e);n=e}function T(){t=0;v.children().each(function(){t+=e(this).outerWidth()});v.css("width",t)}function N(){H();v.addClass("mt-hide");d.addClass("mt-preloader");v.children().remove();v.css("margin-left",0);m.css("opacity","1").removeClass("mt-hide");v.append(m);switch(i.feedType){case"rss-atom":var t={url:i.feedUrl+"?"+Math.random(),type:"GET",dataType:"xml",success:function(t){var n=e(t).find("item");for(var r=0;r<i.feedCount;r++){v.append("<li><a href='"+e(n[r]).find("link").text()+"' target='_blank'>"+e(n[r]).find("title").text()+"</a></li>")}C()}};var n={url:"https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+i.feedCount+"&q="+i.feedUrl+"?"+Math.random(),type:"GET",dataType:"jsonp",success:function(e){var t=e.responseData.feed.entries;for(var n=0;n<t.length;n++){v.append("<li><a href='"+t[n].link+"' target='_blank'>"+t[n].title+"</a></li>")}C()}};var r=i.loadType=="process"?n:t;e.ajax(r);break;case"twitter":e.get("modern-ticker/php/twitter.php",{name:i.twitterName,count:i.feedCount},function(t){t=e.parseJSON(t);for(var n=0;n<t.length;n++){v.append("<li><a href='http://twitter.com/#!/"+t[n].user.id_str+"/status/"+t[n].id_str+"' target='_blank'>"+t[n].text+"</a></li>")}C()});break}}function C(){d.removeClass("mt-preloader");v.removeClass("mt-hide");L()}function k(){if(i.feedType=="rss-atom"||i.feedType=="twitter"){clearTimeout(c);l=false;N()}}function L(){T();if(i.effect!="scroll")v.children("li:not(:first)").addClass("mt-hide");if(f){f=false;if(i.autoplay){D();F()}}else B();M("first");if(i.refresh)c=setTimeout(k,A(i.refresh));l=true}function A(e){var t;if(typeof e=="number")t=e;else{var n=e.split(":");n.reverse();t=parseFloat(n[0]);if(n[1])t+=parseFloat(n[1])*60;if(n[2])t+=parseFloat(n[2])*3600}return t*1e3}function O(e){if(l)M(e.data.type)}function M(r){if(!u){u=true;H();switch(r){case"first":switch(i.effect){case"scroll":if(i.scrollStart=="outside")v.css("margin-left",n);B();break;case"fade":v.children(":first").css({opacity:0}).animate({opacity:1},i.transitionTime,function(){B()});break;case"type":j(v.children(":first").css({opacity:0}).animate({opacity:1},i.transitionTime).children("a"));break;case"slide":v.children(":first").css({opacity:0,"margin-left":i.slideDistance}).animate({opacity:1,"margin-left":0},i.transitionTime,function(){B()});break}u=false;break;case"prev":switch(i.effect){case"scroll":if(i.scrollType=="discontinuous"){var s=_();var o=E.length-1;var a;if(s==-1||s==0){v.animate({"margin-left":n},i.transitionTime,function(){v.css("margin-left",-t);v.animate({"margin-left":-E[o]},i.transitionTime,function(){u=false})})}else{a=-E[s-1];v.animate({"margin-left":a},i.transitionTime,function(){u=false})}}else{v.css({"margin-left":-e(v.children(":last")).outerWidth()}).children(":last").prependTo(v);v.animate({"margin-left":0},i.transitionTime,function(){u=false})}y.mouseleave(function(){B()});break;case"fade":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide");v.children(":last").prependTo(v).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},i.transitionTime,function(){B()});u=false});break;case"type":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide");j(v.children(":last").prependTo(v).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},i.transitionTime).children("a"));u=false});break;case"slide":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide");v.children(":last").prependTo(v).removeClass("mt-hide").css({opacity:0,"margin-left":i.slideDistance}).animate({opacity:1,"margin-left":0},i.transitionTime,function(){B()});u=false});break}break;case"next":switch(i.effect){case"scroll":if(i.scrollType=="discontinuous"){var s=_();var o=E.length-1;var a;if(s==o){v.animate({"margin-left":-t},i.transitionTime,function(){v.css("margin-left",n);v.animate({"margin-left":0},i.transitionTime,function(){u=false})})}else{if(s==-1)a=0;else a=-E[s+1];v.animate({"margin-left":a},i.transitionTime,function(){u=false})}}else{v.animate({"margin-left":-e(v.children(":first")).outerWidth()},i.transitionTime,function(){v.css("margin-left",0).children(":first").appendTo(v);u=false})}b.mouseleave(function(){B()});break;case"fade":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide").appendTo(v);v.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},i.transitionTime,function(){B()});u=false});break;case"type":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide").appendTo(v);j(v.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},i.transitionTime).children("a"));u=false});break;case"slide":v.children(":first").animate({opacity:0},i.transitionTime,function(){e(this).addClass("mt-hide").appendTo(v);v.children(":first").removeClass("mt-hide").css({opacity:0,"margin-left":i.slideDistance}).animate({opacity:1,"margin-left":0},i.transitionTime,function(){B()});u=false});break}break}}}function _(){var e=parseFloat(v.css("margin-left"));var t=E.length;if(e>0){return-1}else{e=Math.abs(e);for(var n=0;n<t-1;n++){if(e>=E[n]&&e<E[n+1])return n}return t-1}}function D(){s=true;if(i.effect=="scroll"){r=setInterval(function(){if(!u){var r=parseFloat(v.css("margin-left"));v.css("margin-left",r-1);if(i.scrollType=="discontinuous"){if(r<0&&Math.abs(r)>t)v.css("margin-left",n)}else{if(r<0&&Math.abs(r)>e(v.children("li")[0]).outerWidth())v.css("margin-left",0).children(":first").appendTo(v)}}},i.scrollInterval)}else{r=setInterval(function(){M("next")},i.displayTime)}}function P(){s=false;clearInterval(r)}function H(){if(s){o=true;P()}}function B(){if(o&&!a){D();o=false}}function j(e){var t=e.html().split("");var n=0;e.html("_");var r=setInterval(function(){var i=e.html().split("_")[0]+t[n++];if(n!=t.length){i+="_"}e.html(i);if(n==t.length){clearInterval(r);B()}},i.typeInterval)}function F(){w.addClass("mt-pause")}function I(){w.removeClass("mt-pause")}function q(){return false}var t;var n;var r;var s=false;var o=false;var u=false;var a=false;var f=true;var l=false;var c;var h=e(this);var p=h.children(".mt-label");var d=h.children(".mt-news");var v=d.children("ul");var m=v.children("li");var g=h.children(".mt-controls");var y=g.children(".mt-prev");var b=g.children(".mt-next");var w=g.children(".mt-play");if(i.effect=="scroll")h.addClass("mt-scroll");p.css("width",p.width());x();e(window).resize(x);if(i.scrollType=="discontinuous"){var E=[];var S=0;v.children().each(function(){E.push(S);S+=e(this).outerWidth()})}d.hover(function(){if(l){H();a=true}},function(){if(l){a=false;B()}});y.mousedown(q).bind("click",{type:"prev"},O);b.mousedown(q).bind("click",{type:"next"},O);w.mousedown(q).click(function(){if(l){if(s){P();I()}else{D();F()}}});if(i.feedType=="rss-atom"||i.feedType=="twitter"){N()}else{L()}h.data("pause",H);h.data("resume",B);h.data("refresh",k)})},pause:function(){return this.each(function(){e(this).data("pause")()})},resume:function(){return this.each(function(){e(this).data("resume")()})},refresh:function(){return this.each(function(){e(this).data("refresh")()})}};e.fn.modernTicker=function(t){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return i.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.modernTicker")}}})(jQuery)